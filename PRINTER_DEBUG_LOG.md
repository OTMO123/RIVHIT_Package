# Godex ZX420i Printer Debug Log

## Текущая проблема
Принтер Godex ZX420i получает данные (файлы копируются), но НЕ печатает. Принтер отвечает на команды статуса, но игнорирует команды печати.

## Что НЕ работает (проверено)

### 1. Прямая отправка на USB порт
```powershell
copy /B "file.prn" "USB002"  # Файл копируется, но не печатает
```

### 2. Форматы команд
- **ZPL формат** (`^XA...^XZ`) - НЕ работает
- **EZPL формат** (`^L...E`) - НЕ работает
- **GZPL формат** - НЕ работает
- **GEPL формат** - НЕ работает
- **TSPL формат** - НЕ работает
- **ESC/POS формат** - НЕ работает

### 3. Различные кодировки
- ASCII - НЕ работает
- Windows-1252 - НЕ работает
- UTF-8 - НЕ работает
- Binary - НЕ работает

### 4. Специальные команды
- Калибровка `~T` - принтер НЕ реагирует
- Подача `~F` - принтер НЕ реагирует
- Сброс `~RR` - принтер НЕ реагирует
- Выход из dump mode `~EG` - НЕ помогает

## Что работает

### 1. Команды статуса
```
~S,CHECK - принтер отвечает статусом
```
Ответ принтера:
```
ZX420i V2.009
USB S/N: 1930066B
Serial port: 96,N,8,1
Ready (00)
```

### 2. Физическое подключение
- Принтер виден в Windows как "Godex ZX420i"
- Порт USB002 активен
- Файлы успешно копируются на порт

## Вероятные причины

1. **Принтер в неправильном режиме**
   - Может быть в режиме драйвера Windows (не RAW)
   - Может ожидать команды через драйвер, а не напрямую

2. **Неправильный протокол**
   - Принтер может требовать специальный протокол Godex
   - Возможно, нужна специальная инициализация

3. **Проблема с драйвером**
   - Windows драйвер может перехватывать RAW команды
   - Нужен специальный Godex драйвер для RAW печати

## Рекомендуемые инструменты для исследования

### 1. **GoLabel** (официальная программа Godex)
- Скачать с: https://www.godexprinters.co.uk/downloads/
- Позволяет проверить:
  - Текущий режим принтера
  - Язык команд (EZPL/GEPL/GZPL)
  - Настройки порта
  - Тестовую печать

### 2. **Godex Windows Driver**
- Официальный драйвер с поддержкой RAW печати
- Включает утилиты диагностики

### 3. **Seagull Drivers by NiceLabel**
- Универсальные драйверы для термопринтеров
- Поддерживают Godex и RAW режим

### 4. **BarTender UltraLite** (бесплатная версия)
- Профессиональное ПО для этикеток
- Поддерживает Godex принтеры
- Может экспортировать команды принтера

### 5. **ZebraDesigner** (работает с Godex в режиме эмуляции)
- Если принтер в режиме ZPL эмуляции

## План тестирования

### Этап 1: Диагностика через GoLabel
1. Установить GoLabel
2. Проверить настройки принтера
3. Выполнить тестовую печать
4. Экспортировать рабочие команды

### Этап 2: Проверка режима драйвера
1. Открыть свойства принтера в Windows
2. Вкладка "Дополнительно" → "Процессор печати"
3. Установить "RAW" если стоит другое
4. Перезапустить спулер печати

### Этап 3: Альтернативные методы отправки

#### Через Windows Print Spooler
```powershell
$printer = Get-WmiObject -Query "SELECT * FROM Win32_Printer WHERE Name='Godex ZX420i'"
$printer.PrintTestPage()
```

#### Через .NET PrintDocument
```csharp
using System.Drawing.Printing;
PrintDocument pd = new PrintDocument();
pd.PrinterSettings.PrinterName = "Godex ZX420i";
pd.Print();
```

#### Через Node.js библиотеки
- **node-printer** - нативная печать Windows
- **node-thermal-printer** - специально для термопринтеров
- **pdf-to-printer** - через Windows спулер

### Этап 4: Проверка специфичных команд Godex

#### Godex Binary Protocol (GBP)
```
0x1B 0x21 0x00  // Initialize
SIZE 80 mm,50 mm
GAP 3 mm,0 mm
DIRECTION 1
CLS
TEXT 100,100,"3",0,1,1,"TEST"
PRINT 1,1
```

#### Godex Command Protocol (GCP)
```
! 0 200 200 210 1
TEXT 0 0 10 10 Test
FORM
PRINT
```

## Native решения для печати

### 1. **Windows GDI+ Printing**
- Использует стандартный Windows API
- Работает через драйвер принтера

### 2. **WinSpool API**
```c
OpenPrinter()
StartDocPrinter()
WritePrinter()
EndDocPrinter()
ClosePrinter()
```

### 3. **USB Direct Communication**
- libusb для прямого доступа к USB
- WinUSB API для Windows

### 4. **Godex DLL SDK**
- Godex предоставляет SDK для разработчиков
- Gprinter.dll для прямого управления

## Следующие шаги

1. **Установить GoLabel** - проверить настройки принтера
2. **Проверить режим драйвера** - должен быть RAW
3. **Попробовать Godex SDK** - если доступен
4. **Использовать node-printer** - для печати через спулер
5. **Захватить рабочие команды** - через монитор порта

## Контакты поддержки
- Godex Support: support@godexintl.com
- Документация: https://www.godexprinters.co.uk/support/

---
Последнее обновление: 2025-08-29